# PenRoseBlog 后续优化规划

> **最后更新**: 2025年12月11日

本文档旨在规划 PenRoseBlog 项目的未来技术演进与功能优化方向。

## 1. 后端架构优化 (Backend)

### 1.1 性能与缓存
- **多级缓存策略**:
  - 引入 Caffeine 本地缓存，用于存储极热点数据（如首页配置、热门文章列表），减少 Redis 访问频率。
  - 优化 Redis 键值设计，使用 Hash 结构存储对象，减少内存占用。
- **数据库优化**:
  - 引入读写分离，主库负责写，从库负责读。
  - 针对 `blog_view_record` 等大数据量表进行分表处理（按月或按用户ID取模）。
  - 完善慢查询监控，定期分析并优化 SQL 执行计划。

### 1.2 异步与消息队列
- **RabbitMQ 深度集成**:
  - 将邮件发送、站内信持久化、搜索索引更新等非核心链路逻辑完全剥离至消息队列消费者。
  - 实现死信队列（DLQ）处理消费失败的消息，确保数据最终一致性。

### 1.3 安全性增强
- **接口限流**: 集成 Bucket4j 或 Redis Lua 脚本，对高频接口（如登录、点赞、评论）实施 IP/用户维度的限流。
- **内容风控**: 接入第三方内容审查 API（文本/图片），自动过滤违规内容。
- **SQL 注入与 XSS 防护**: 强化输入参数校验，确保所有富文本渲染经过严格的 XSS 过滤。

## 2. 前端体验升级 (Frontend)

### 2.1 性能优化
- **代码分割 (Code Splitting)**: 利用 `React.lazy` 和 `Suspense` 对路由组件进行懒加载，减小首屏包体积。
- **图片优化**: 全面启用 WebP 格式，实现图片懒加载（Lazy Loading）和渐进式加载。
- **PWA 支持**: 配置 Service Worker，实现离线访问能力和更快的二次加载速度。

### 2.2 用户体验 (UX)
- **骨架屏 (Skeleton Screens)**: 在数据加载期间展示骨架屏代替 Loading 转圈，提升感官流畅度。
- **无障碍访问 (A11y)**: 遵循 WAI-ARIA 标准，优化键盘导航和屏幕阅读器支持。
- **深色模式**: 完善系统级深色模式适配，支持自动切换。

### 2.3 架构演进
- **状态管理**: 评估引入 Zustand 或 Redux Toolkit 替代部分复杂的 Context，提升渲染性能。
- **TypeScript 迁移**: 逐步将 JSX 迁移至 TSX，增强代码健壮性和可维护性。

## 3. 运维与监控 (DevOps)

### 3.1 容器化与编排
- **Docker 镜像瘦身**: 使用 Multi-stage builds 减少最终镜像体积。
- **健康检查**: 在 `docker-compose` 中完善 `healthcheck` 配置，确保服务依赖启动顺序正确。

### 3.2 监控告警
- **全链路监控**: 部署 Prometheus + Grafana，监控 JVM 堆内存、线程池、数据库连接池及 Redis 指标。
- **日志聚合**: 引入 ELK (Elasticsearch, Logstash, Kibana) 或 Loki 栈，集中管理分布式日志。

### 3.3 CI/CD
- **自动化流水线**: 建立 GitHub Actions 工作流，实现代码提交后的自动构建、测试和 Docker 镜像推送。
